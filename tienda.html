<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>E&S</title>

  <!-- UI / Iconos -->
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Lustria:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet" />

  <!-- Estilos / App -->
  <link rel="stylesheet" href="estilos.css" />
  <script src="script.js?v=build-2025-10-13-01" defer></script>
</head>
<body>

<header class="header">
  <div class="container nav">
    <!-- IZQUIERDA: menú -->
    <nav class="links" aria-label="Principal">
      <details class="dd" id="menuMujer">
        <summary class="btn btn-sm bg-[#7a4545] text-white hover:brightness-95 rounded-full shadow-md border-0 gap-1">
          <span>Mujer</span>
          <span class="material-symbols-outlined dd-caret transition-transform duration-200 align-middle text-base">expand_more</span>
        </summary>

        <div class="dd-panel" role="menu">
          <div class="col">
            <h4>Categorías</h4>
            <a href="#" data-kind="remeras">Remeras</a>
            <a href="#" data-kind="pantalones">Pantalones</a>
            <a href="#" data-kind="vestidos">Vestidos</a>
          </div>
          <div class="col">
            <h4>Talles</h4>
            <a href="#" data-size="XS">XS</a>
            <a href="#" data-size="S">S</a>
            <a href="#" data-size="M">M</a>
            <a href="#" data-size="L">L</a>
          </div>
          <div class="col">
            <h4>Colores</h4>
            <a href="#" data-color="negro">Negro</a>
            <a href="#" data-color="blanco">Blanco</a>
            <a href="#" data-color="rojo">Rojo</a>
            <a href="#" data-color="celeste">Celeste</a>
            <a href="#" data-color="azul">Azul</a>
          </div>
          <div class="col">
            <h4>&nbsp;</h4>
            <a href="#" data-clear="1">Limpiar filtros</a>
          </div>
        </div>
      </details>
    </nav>

    <!-- CENTRO: logo -->
    <a class="logo" href="index.html">E&amp;S</a>

    <!-- DERECHA: iconos (CORREGIDO: bolsa con id="bagBtn") -->
    <div class="icons">
  <a class="icon-btn account" href="cliente_login.php" aria-label="Mi cuenta">
    <span class="material-symbols-outlined">person</span>
  </a>

  <!-- Botón de la bolsa con IDs que usa el JS -->
  <button id="bagBtn" class="icon-btn bag" aria-label="Carrito">
    <span class="material-symbols-outlined">shopping_bag</span>
    <span class="badge" id="bagCount">0</span>
  </button>
</div>

  </div>
</header>

<!-- CARRUSEL -->
<section class="container hero">
  <div class="carousel rounded-box">
    <div class="carousel-item"><img src="modelo1.jpeg" alt="modelo 1" /></div>
    <div class="carousel-item"><img src="modelo2.jpeg" alt="modelo 2" /></div>
    <div class="carousel-item"><img src="modelo3.jpeg" alt="modelo 3" /></div>
    <div class="carousel-item"><img src="modelo4.jpeg" alt="modelo 4" /></div>
    <div class="carousel-item"><img src="modelo5.jpeg" alt="modelo 5" /></div>
    <div class="carousel-item"><img src="modelo6.jpeg" alt="modelo 6" /></div>
    <div class="carousel-item"><img src="modelo7.jpeg" alt="modelo 7" /></div>
    <div class="carousel-item"><img src="modelo8.jpeg" alt="modelo 8" /></div>
    <div class="carousel-item"><img src="modelo9.jpeg" alt="modelo 9" /></div>
  </div>
</section>

<!-- PRODUCTOS -->
<main class="container" id="productos">
  <h2 class="sr-only">Productos</h2>
  <div id="grid" class="product-container"></div>
</main>

<!-- PLANTILLA -->
<template id="tpl-producto">
  <article class="product" data-id="">
    <img data-src="imagen" alt="">
    <div class="meta">
      <h2 data-txt="nombre">Producto</h2>
      <p class="price" data-txt="precio">$0</p>
    </div>
    <button class="add" data-action="add">Agregar al carrito</button>
  </article>
</template>

<noscript>
  <p style="text-align:center; padding:2rem;">Necesitás activar JavaScript para ver los productos.</p>
</noscript>

<!-- DETALLE -->
<dialog id="productDialog" class="modal">
  <div class="modal-box max-w-3xl p-0 overflow-hidden">
    <button class="btn btn-sm btn-circle absolute right-3 top-3"
            onclick="document.getElementById('productDialog').close()">✕</button>

    <div class="pd-body p-4">
      <div>
        <img id="pdImg" class="pd-img" alt="">
        <div id="pdThumbs" class="pd-thumbs"></div>
      </div>
      <div class="pd-info">
        <h3 id="pdName" class="pd-name">Producto</h3>
        <p id="pdPrice" class="pd-price">$0</p>

        <div class="pd-row">
          <span class="pd-label">Color</span>
          <div id="pdColors" class="pd-colors"><span class="text-sm text-gray-500">—</span></div>
        </div>

        <div class="pd-row">
          <span class="pd-label">Talles</span>
          <div id="pdSizes" class="pd-sizes"><span class="text-sm text-gray-500">—</span></div>
        </div>

        <button id="pdAdd" class="btn bg-[#7a4545] text-white hover:brightness-95 mt-2">
          Agregar al carrito
        </button>
      </div>
    </div>
  </div>
</dialog>

<footer class="pie">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
      <div>
        <h2 class="text-2xl font-bold mb-2">E&amp;S</h2>
        <p class="text-sm opacity-80">
          Tienda especializada en moda y estilo, con envío nacional y productos de calidad.
          Nuestra misión es que te sientas cómoda y auténtica con cada elección.
        </p>
      </div>
      <div>
        <h3 class="text-lg font-semibold mb-3">Enlaces útiles</h3>
        <ul class="space-y-2">
          <li><a href="terminos.html" class="hover:text-white">Términos y condiciones</a></li>
          <li><a href="privacidad.html" class="hover:text-white">Política de privacidad</a></li>
        </ul>
      </div>
      <div>
        <h3 class="text-lg font-semibold mb-3">Contacto & Redes</h3>
        <ul class="space-y-2 text-sm">
          <li>Email: <a href="mailto:ESindumentaria@gmail.com" class="hover:text-white">ESindumentaria@gmail.com</a></li>
          <li>Teléfono: <a href="tel:+5492611234567" class="hover:text-white">+54 9 261 123-4567</a></li>
          <li>Dirección: San Martín 123, Mendoza, Argentina</li>
        </ul>
        
      </div>
    </div>

    <hr class="my-8 border-gray-700" />
    <div class="text-center text-sm opacity-70">
      &copy; <span id="anio-current"></span> E&amp;S. Todos los derechos reservados.
    </div>
  </div>
</footer>

<script>
  document.getElementById("anio-current").textContent = new Date().getFullYear();
</script>

<!-- MODAL CARRITO (ÚNICO) -->
<dialog id="cartDlg" class="modal checkout-page">
  <div class="modal-box p-0 overflow-hidden card-accent">
    <!-- Header -->
    <div class="cart-header px-6 py-4 flex items-center justify-between">
      <h3 class="text-lg font-semibold text-white">Tu carrito</h3>
      <form method="dialog">
        <button class="btn btn-sm btn-ghost">Cerrar</button>
      </form>
    </div>

    <!-- Body -->
    <div id="cartList" class="px-6 py-6 divide-y">
      <!-- El JS insertará aquí los items o el estado vacío -->
    </div>

    <!-- Footer -->
    <div class="px-6 py-4 flex items-center justify-between border-t">
      <span class="font-semibold">Total: <span id="cartTotal">ARS 0</span></span>
      <div class="flex gap-3">
        <button id="clearCartBtn" class="btn btn-ghost">Vaciar</button>
        <a href="checkout.php" class="btn btn-primary">Finalizar compra</a>
      </div>
    </div>
  </div>
</dialog>
<script>
  // Test directo del modal (independiente del resto del JS)
  const __bagBtn   = document.getElementById('bagBtn');
  const __cartDlg  = document.getElementById('cartDlg');
  const __cartList = document.getElementById('cartList');
  const __cartTotal= document.getElementById('cartTotal');

  function __openMiniCart() {
    // contenido de prueba por si no hay nada aún
    if (__cartList && __cartTotal) {
      __cartList.innerHTML = '<div class="empty">Tu carrito está vacío.</div>';
      __cartTotal.textContent = 'ARS 0';
    }
    if (__cartDlg?.showModal) {
      __cartDlg.showModal();
    } else {
      // Fallback si el browser no soporta <dialog>
      __cartDlg?.setAttribute('open','');
      document.documentElement.classList.add('modal-open');
    }
  }

  __bagBtn?.addEventListener('click', (e) => {
    e.preventDefault();
    __openMiniCart();
  });

  // Debug rápido en consola:
  console.log('[carrito:test]', {
    bagBtn: !!__bagBtn,
    cartDlg: !!__cartDlg,
    cartList: !!__cartList,
    cartTotal: !!__cartTotal,
    hasShowModal: typeof __cartDlg?.showModal === 'function'
  });
</script>

</body>
</html>
